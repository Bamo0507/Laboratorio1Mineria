---
title: "Laboratorio 1 - Películas"
author: "Bryan Martínez"
date: "2026-02-02"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(nortest)
library(dplyr)
library(stringr)
library(tidyr)
library(readr)
```

# Laboratorio 1 - CineVision Studios

```{r}
# Helpers para columnas con "|"
split_pipe <- function(x) {
  if (is.na(x) || x == "") return(character(0))
  parts <- unlist(strsplit(x, "\\|"))
  parts <- trimws(parts)
  parts[parts != ""]
}

split_pipe_num <- function(x) {
  nums <- suppressWarnings(as.numeric(split_pipe(x)))
  nums[!is.na(nums)]
}

safe_mean <- function(x) if (length(x) == 0) NA_real_ else mean(x, na.rm = TRUE)

movies_raw <- readr::read_csv(
  "movies_2026.csv",
  locale = readr::locale(encoding = "latin1"),
  show_col_types = FALSE
)

movies <- movies_raw %>%
  mutate(
    # actorsPopularity -> métricas (para manejar 3.45|12.31|...)
    actorsPopularity_mean = sapply(lapply(actorsPopularity, split_pipe_num), safe_mean),
  )

movies_cuant <- movies[sapply(movies, is.numeric)]
movies_cual  <- movies[sapply(movies, function(x) !is.numeric(x))]
```

## Exploración de Datos

```{r}
# Dimensión del conjunto de datos
dim(movies) #<-- Cuántas filas y columnas tiene el dataset

# Estructura de los datos
str(movies) #<--- Tipo de variables (numéricas, categóricas, texto, etc.)

# Resumen estadístico general
summary(movies) #<-- Exploración rápida:  - Mínimo, máximo, media, mediana (variables numéricas)  - Frecuencias (variables categóricas)\
```

Conclusion: A partir de la exploración inicial del conjunto de datos se observa que el dataset contiene **19,883 observaciones y 28 variables**, lo que representa un volumen de datos considerable para el análisis.

La estructura del conjunto de datos muestra una **combinación de variables numéricas, lógicas y de tipo carácter**. Las variables de tipo carácter predominan en campos descriptivos como *géneros, director, actores, títulos, idioma original y países de producción*, lo cual indica que gran parte de la información es cualitativa y requiere procesos adicionales de limpieza o transformación para análisis más avanzados.

Las variables numéricas incluyen información relevante como *presupuesto, ingresos, duración, popularidad, calificación promedio y conteo de votos*. Se observa que varias de estas variables presentan **valores mínimos iguales a cero**, especialmente en *budget, revenue, voteAvg y voteCount*, lo que sugiere la existencia de películas sin información financiera o de votación registrada.

El resumen estadístico también evidencia la presencia de **valores extremos**, por ejemplo en *budget, revenue, actorsAmount, castWomenAmount y castMenAmount*, lo cual podría influir en medidas como la media y requerir el uso de medidas robustas como la mediana en análisis posteriores.

Finalmente, se identifican **valores faltantes (NA)** en algunas variables, como *video, castWomenAmount, castMenAmount y releaseYear*, por lo que será necesario considerar técnicas de manejo de datos faltantes antes de realizar análisis más profundos.

---

## Clasificación de Variables

| Variable                  | Tipo         | Subtipo  |
|---------------------------|--------------|----------|
| id                        | Cualitativa  | Nominal  |
| originalTitle             | Cualitativa  | Nominal  |
| originalLanguage          | Cualitativa  | Nominal  |
| title                     | Cualitativa  | Nominal  |
| homePage                  | Cualitativa  | Nominal  |
| video                     | Cualitativa  | Nominal  |
| director                  | Cualitativa  | Nominal  |
| genres                    | Cualitativa  | Nominal  |
| productionCompany         | Cualitativa  | Nominal  |
| productionCompanyCountry  | Cualitativa  | Nominal  |
| productionCountry         | Cualitativa  | Nominal  |
| actors                    | Cualitativa  | Nominal  |
| actorsCharacter           | Cualitativa  | Nominal  |
| genresAmount              | Cuantitativa | Discreta |
| productionCoAmount        | Cuantitativa | Discreta |
| productionCountriesAmount | Cuantitativa | Discreta |
| voteCount                 | Cuantitativa | Discreta |
| actorsAmount              | Cuantitativa | Discreta |
| castWomenAmount           | Cuantitativa | Discreta |
| castMenAmount             | Cuantitativa | Discreta |
| releaseYear               | Cuantitativa | Discreta |
| popularity                | Cuantitativa | Continua |
| budget                    | Cuantitativa | Continua |
| revenue                   | Cuantitativa | Continua |
| runtime                   | Cuantitativa | Continua |
| voteAvg                   | Cuantitativa | Continua |
| actorsPopularity_mean     | Cuantitativa | Continua |
| releaseDate               | Cualitativa  | Ordinal  |

actorsPopularity_mean es la variable que se generó para gestionar correctamente la variable actorsPopularity, la cual tenía los datos distribuidos como 1|123|3.23

## Análisis de Frecuencia/Distribución

#### Distribuciones

H0: La variable sigue una distribución normal H1: La variable NO sigue una distribución normal

```{r}
lillie_results <- lapply(movies_cuant, lillie.test)
```

**budget**

```{r}
hist(movies_cuant$budget)
lillie_results$budget
```

-   La distribución no es normal, gráficamente se visualiza un sesgo considerable hacia la izquierda. Adicionalmente, el p-value es de 2.2e-16, confirma el rechazo de la normalidad.

**revenue**

```{r}
hist(movies_cuant$revenue)
lillie_results$revenue
```

-   Igual que con la variable "budget", gráficamente se identifica un sesgo hacia la izquierda, y al p-value ser de 2.2e-16 se dice que no tiene una distribución normal.

**runtime**

```{r}
hist(movies_cuant$runtime)
lillie_results$runtime
```

-   Gráficamente se identifica un sesgo hacia la izquierda, y el p-value es de 2.2e-16 por lo que se dice que no sigue una distribución normal.

**popularity**

```{r}
hist(movies_cuant$popularity)
lillie_results$popularity
```

-   Se evidencia que el gráfico está sesgado hacia la izquierda, y el valor-p es 2.2e-16 por lo que se dice que no sigue una distribución normal.

**voteAvg**

```{r}
hist(movies_cuant$voteAvg)
lillie_results$voteAvg
```

-   Gráficamente se ve que se tiene una alta concentración en los valores bajos, y otros están alrededor de y 8. Además, el p-value es de 2.2e-16 por lo que se rechaza que tenga distribución normal.

**voteCount**

```{r}
hist(movies_cuant$voteCount)
lillie_results$voteCount
```

-   El gráfico se ve sesgado a la izquierda, y el p-value es de 2.2e-16 por lo que no tiene uns distribución normal.

**genresAmount**

```{r}
hist(movies_cuant$genresAmount)
lillie_results$genresAmount
```

-   En el gráfico se ve que los datos están concentrados hacia la izquierda, y el p-value 2.2e-16 indica que no es una distribución normal.

**productionCoAmount**

```{r}
hist(movies_cuant$productionCoAmount)
lillie_results$productionCoAmount
```

-   Los datos están considerablemente sesgados a la izquierda en el gráfico, y el p-value es 2.2e-16 entonces no hay distribución normal.

**productionCountriesAmount**

```{r}
hist(movies_cuant$productionCountriesAmount)
lillie_results$productionCountriesAmount
```

-   Una vez más los datos están sesgados a la izquierda y el p-value es de 2.2e-16 por lo que se dice que no tiene una distribución normal.

**actorsAmount**

```{r}
hist(movies_cuant$actorsAmount)
lillie_results$actorsAmount
```

-   Los datos están sesgados a la izquierda y el p-value es de 2.2e-16, entonces no hay distribución normal.

**castWomenAmount**

```{r}
hist(movies_cuant$castWomenAmount)
lillie_results$castWomenAmount
```

-   Gráficamente los datos están concentrados a la izquierda y el p-value es de 2.2e-16 por lo que no hay distribución normal.

**castMenAmount**

```{r}
hist(movies_cuant$castMenAmount)
lillie_results$castMenAmount
```

-   Se evidencia que el gráfico está sesgado hacia la izquierda, y el valor-p es 2.2e-16 por lo que se dice que no sigue una distribución normal.

**releaseYear**

```{r}
hist(movies_cuant$releaseYear)
lillie_results$releaseYear
```

-   Los datos están sesgados hacia la derecha en el gráfico y el p-value es de 2.2e-16, por lo que la distribución no es normal.

**actorsPopularity_mean**


```{r}
hist(movies_cuant$actorsPopularity_mean)
lillie_results$actorsPopularity_mean
```

-   Los datos se ven sesgados a la izquierda, y con un p-value de 2.2e-16 se puede confirmar que no se distribuyen normalmente.

> Ninguno de las variables presentadas está distribuida normalmente.

------------------------------------------------------------------------

#### Frecuencia

```{r}
freqs <- lapply(movies_cual, table)

clean_freq <- function(x, top_n = 20) {
  x <- x[!is.na(x)]
  x <- trimws(x) 
  x <- stringr::str_squish(x)    
  x <- x[x != ""]                

  df <- as.data.frame(table(x))
  colnames(df) <- c("Value", "Count")

  df %>%
    arrange(desc(Count)) %>%
    head(top_n)
}

clean_freq(movies_cual$productionCompanyCountry)
```

---

```{r}
clean_freq(movies_cual$video)
```

---

```{r}
clean_freq(movies_cual$director)
```

---

```{r}
clean_freq(movies_cual$title)
```

---

```{r}
clean_freq(movies_cual$originalLanguage)
```

---

```{r}
clean_freq(movies_cual$releaseDate)
```

---

Las frecuencias de variables multivalor (cuyas observaciones estaban separadas por '|'), se decidió no incluirlas en las tablas de frecuencia por su estructura. Asimismo, se omitió la variable homePage, al ser algo que no aportaba valor al análisis a realizar, además de ser único para cada película. Para las tablas de frecuencia se excluyeron valores faltantes y vacíos. Debido a la alta cardinalidad de algunas variables, se presentan únicamente los 20 valores más frecuentes para facilitar la interpretación.

---

## Análisis de Preguntas

---

#### 4.1. ¿Cuáles son las 10 películas que contaron con más presupuesto?

```{r}
top10_budget <- movies[order(movies$budget, decreasing = TRUE), c("title", "budget")]

head(top10_budget, 10)
```

---

#### 4.2.¿Cuáles son las 10 películas que más ingresos tuvieron?

```{r}
top10_revenue <- movies[order(movies$revenue, decreasing = TRUE, na.last = TRUE),
                         c("title", "revenue")]

head(top10_revenue, 10)
```

---

#### 4.3.¿Cuál es la película que más votos tuvo?

```{r}
pelicula_mas_votos <- movies[order(movies$voteCount, decreasing = TRUE, na.last = TRUE),
                              c("title", "voteCount")]

head(pelicula_mas_votos, 1)
```

---

#### 4.4 ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

```{r}
peor_pelicula <- movies[
  order(movies$voteAvg, decreasing = FALSE, na.last = TRUE),
  c("title", "voteAvg")
]

head(peor_pelicula, 1)
```

---

#### 4.5. ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras

```{r}

pelis_por_anio <- table(movies$releaseYear)

anio_mas_peliculas <- data.frame(
  Anio = names(pelis_por_anio),
  Cantidad = as.vector(pelis_por_anio)
)[which.max(pelis_por_anio), ]

barplot(
  pelis_por_anio,
  main = "Cantidad de películas por año",
  xlab = "Año de lanzamiento",
  ylab = "Número de películas",
  las = 2
)
```

El año con más películas es:

```{r}
anio_mas_peliculas
```

---

**Aclaración para gestión de preguntas de género principal**

Para abordar estos problemas que van relacionados al género principal, lo que se realizó fue generar una columna nueva denominada "mainGenre", la idea es que para el género principal nos quedaremos con el primer elemento que se tenga en la columna de genres (cuyos datos vienen como Drama|Crime).

```{r}
movies <- movies %>%
  mutate(
    mainGenre = sapply(genres, function(g) {
      split_pipe(g)[1]
    })
  )
```

---

#### 4.6 ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico. ¿A qué género principal pertenecen las películas más largas?

```{r}
# pasar release date a Date
movies <- movies %>%
  mutate(releaseDateParsed = as.Date(releaseDate))

top20_genre_counts <- top20_recent %>%
  filter(!is.na(mainGenre), mainGenre != "") %>%
  count(mainGenre, sort = TRUE)

barplot(
  top20_genre_counts$n,
  names.arg = top20_genre_counts$mainGenre,
  las = 2,                         # gira etiquetas
  col = "steelblue",
  main = "Géneros principales de las 20 películas más recientes",
  ylab = "Cantidad de películas",
  xlab = "Género principal"
)

main_genre_counts <- movies %>%
  filter(!is.na(mainGenre), mainGenre != "") %>%
  count(mainGenre, sort = TRUE)

barplot(
  main_genre_counts$n,
  names.arg = main_genre_counts$mainGenre,
  las = 2,
  col = "steelblue",
  main = "Distribución del género principal en el conjunto de datos",
  ylab = "Cantidad de películas",
  xlab = "Género principal"
)

topN <- 20

longest_movies <- movies %>%
  filter(!is.na(mainGenre), mainGenre != "", !is.na(runtime), runtime > 0) %>%
  arrange(desc(runtime)) %>%
  slice_head(n = topN)

longest_genre_counts <- longest_movies %>%
  count(mainGenre, sort = TRUE)

# Gráfico de barras
barplot(
  longest_genre_counts$n,
  names.arg = longest_genre_counts$mainGenre,
  las = 2,
  main = paste("Género principal de las", topN, "películas más largas"),
  ylab = "Cantidad de películas",
  xlab = "Género principal"
)
```
Entre las 20 películas recientes, los géneros principales fueron: drama, animación, y comedia. En el conjunto de datos, una vez más el género principal es drama, y seguido está comedia y documentales. Esto evidencia una preferencia a lo largo de la línea del tiempo en el mundo cinematográfico para el género de drama. Adicionalmente, si nos enfocamos en las 20 películas más largas, una vez más, drama aparece como el tercer género más común entre estas, por atrás únicamente de acción y documentales. En general, las películas tienden a enfocarse a un tono dramático.

---

#### 4.7 ¿Las películas de qué genero principal obtuvieron mayores ganancias?

Para esta pregunta, el criterio fue dividir los datos acorde a su "mainGenre" para posteriormente sumar el revenue acorde a género. Utilizando estos datos se determina que el top 10 de géneros que más ganancias generan son:

```{r}
revenue_by_genre <- movies %>%
  filter(
    !is.na(mainGenre), mainGenre != "",
    !is.na(revenue), revenue > 0
  ) %>%
  group_by(mainGenre) %>%
  summarise(
    total_revenue = sum(revenue, na.rm = TRUE),
    n_movies = n()
  ) %>%
  arrange(desc(total_revenue))

top10_revenue_genres <- head(revenue_by_genre, 10)

barplot(
  top10_revenue_genres$total_revenue,
  names.arg = top10_revenue_genres$mainGenre,
  las = 2,
  main = "Top 10 géneros principales con mayores ganancias (revenue total)",
  ylab = "Revenue total",
  xlab = "Género principal"
)
```

Las mayores ganancias se presentan en los géneros de acción, aventura, comedia, drama, y animación.

---

#### 4.8 ¿La cantidad de actores influye en los ingresos de las películas? ¿se han hecho películas con más actores en los últimos años?

Para determinar si hay una relación entre la cantidad de actores y los ingresos, se ha encontrado la correlación entre ambas variables. Para este proceso no se tomaron en cuenta las películas con ingresos en 0. La correlación es de:

```{r}
movies_corr <- movies %>%
  filter(
    !is.na(actorsAmount), actorsAmount > 0,
    !is.na(revenue), revenue > 0
  ) %>%
  select(actorsAmount, revenue)

pearson_cor  <- cor(movies_corr$actorsAmount, movies_corr$revenue, method = "pearson")

pearson_cor
```

Lo que nos indica que no hay relación entre actores y los ingresos.

```{r}
actors_avg_by_20y <- movies %>%
  filter(!is.na(releaseYear), !is.na(actorsAmount), actorsAmount > 0) %>%
  mutate(
    year_block_start = floor(releaseYear / 20) * 20,
    year_block = paste0(year_block_start, "-", year_block_start + 19)
  ) %>%
  group_by(year_block_start, year_block) %>%
  summarise(
    avg_actors_per_movie = mean(actorsAmount, na.rm = TRUE),
    n_movies = n(),
    .groups = "drop"
  ) %>%
  arrange(year_block_start)

heights <- actors_avg_by_20y$avg_actors_per_movie
labels  <- actors_avg_by_20y$year_block

bp <- barplot(
  heights,
  names.arg = labels,
  las = 2,
  col = "steelblue",
  main = "Promedio de actores por película por bloque de 20 años",
  ylab = "Actores promedio por película (actorsAmount)",
  xlab = "Bloque de años"
)

# Mostrar el valor promedio encima de cada barra (redondeado)
text(
  x = bp,
  y = heights,
  labels = round(heights, 2),
  pos = 3,
  cex = 0.8
)
```

Se agruparon las películas en bloques de 20 años según releaseYear y se calculó el promedio de actorsAmount por película en cada bloque, excluyendo registros con actorsAmount = 0. Al hacer esto, se encontró que efectivamente, en los últimos años se tiene una mayor cantidad de actores en estas películas, lo que se puede atribuir al aumento en presupuesto en estos tiempos.

---

#### 4.9 ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?

```{r}
cast_impact <- movies %>%
  filter(
    !is.na(castMenAmount), !is.na(castWomenAmount),
    castMenAmount >= 0, castWomenAmount >= 0,
    !is.na(popularity), popularity > 0,
    !is.na(revenue), revenue > 0
  ) %>%
  mutate(
    castGroup = case_when(
      castMenAmount > castWomenAmount ~ "Más hombres",
      castWomenAmount > castMenAmount ~ "Más mujeres",
      TRUE ~ "Balanceado"
    )
  ) %>%
  group_by(castGroup) %>%
  summarise(
    n_movies = n(),
    avg_popularity = mean(popularity, na.rm = TRUE),
    avg_revenue = mean(revenue, na.rm = TRUE),
    .groups = "drop"
  )

cast_impact
```

Al comparar por grupos, se encontró que las películas con más hombres que mujeres, tienen en promedio mayor popularidad e ingresos que las películas con un reparto balanceado (misma cantidad de actrices que actores) y que las que tienen mayor cantidad de hombres. Por lo que, puede existir un impacto positivo en cuanto a visibilidad y ganancias de las películas si predomina la cantidad de actores en el reparto.

---

#### 4.10. ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?

```{r}
top20_mejor_calificadas <- movies[
  order(movies$voteAvg, decreasing = TRUE, na.last = TRUE),
  c("title", "director", "voteAvg")
]

top20_mejor_calificadas <- head(top20_mejor_calificadas, 20)

directores_top20 <- data.frame(
  Director = unique(top20_mejor_calificadas$director)
)

directores_top20
```

---

#### 4.11 ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos? Haga los gráficos que necesite, histograma, diagrama de dispersión

```{r}
budget_rev <- movies %>%
  filter(!is.na(budget), !is.na(revenue), budget > 0, revenue > 0) %>%
  select(budget, revenue)

plot(
  budget_rev$budget,
  budget_rev$revenue,
  xlab = "Presupuesto (budget)",
  ylab = "Ingresos (revenue)",
  main = "Diagrama de dispersión: Presupuesto vs Ingresos"
)

pearson_cor <- cor(budget_rev$budget, budget_rev$revenue, method = "pearson")
pearson_cor

cor.test(budget_rev$budget, budget_rev$revenue, method = "pearson")
```

En el gráfico se logró identificar una tendencia positiva entre ambas variables, con algunos puntos como claros outliers. Al obtener una correlación de 0.7228, se identifica una relación positiva entre moderada y alta entre el presupuesto y los ingresos. Sin embargo, la dispersión entre los datos puede sugerir que hayan más variables que puedan impactar los ingresos generados.

---
# 4.12 ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?
```{r}
boxplot(
  revenue ~ format(as.Date(releaseDate), "%m"),
  data = movies,
  xlab = "Mes de lanzamiento",
  ylab = "Ingresos",
  main = "Ingresos por mes de lanzamiento"
)
```
Conclusión:

El diagrama de cajas muestra que los ingresos varían según el mes de lanzamiento.
Se observan meses con medianas más altas y mayor dispersión de ingresos,
lo que sugiere que el momento del estreno puede influir en el desempeño comercial
de las películas.

---
# 4.13 ¿En qué meses se han visto los lanzamientos con mejores ingresos y cuántas películas, en promedio, se lanzan por mes?
# Ingreso promedio por mes de lanzamiento

```{r}
aggregate(
  revenue ~ format(as.Date(releaseDate), "%m"),
  data = movies,
  mean
)

# Cantidad de películas por mes
table(format(as.Date(movies$releaseDate), "%m"))

# Promedio de películas lanzadas por mes
mean(table(format(as.Date(movies$releaseDate), "%m")))
```

---
El ingreso promedio varía entre los distintos meses del año, observándose
algunos meses con mejores resultados económicos. La cantidad de películas
lanzadas por mes es relativamente constante, lo que indica una distribución
uniforme de estrenos a lo largo del año.
---

# 4.14 ¿Cómo se correlacionan las calificaciones con el éxito comercial?
```{r}
# Correlación entre calificación promedio y ingresos
cor(movies$voteAvg, movies$revenue, use = "complete.obs")

# Gráfico de dispersión
plot(movies$voteAvg, movies$revenue,
     xlab = "Calificación promedio",
     ylab = "Ingresos",
     main = "Calificación promedio vs Ingresos")
```

La correlación entre la calificación promedio y los ingresos es baja,
lo que indica que una mejor calificación no garantiza necesariamente
un mayor éxito comercial en taquilla.
---
# 4.15 ¿Qué estrategias de marketing, como videos promocionales o páginas oficiales, generan mejores resultados?
```{r}
# Ingresos promedio según la existencia de video promocional
aggregate(revenue ~ video, data = movies, mean)

# Ingresos promedio según la existencia de página oficial
aggregate(revenue ~ (homePage != ""), data = movies, mean)
```
Las películas que cuentan con videos promocionales o con una página oficial
presentan mayores ingresos promedio, lo que sugiere que las estrategias
de marketing digital influyen positivamente en el desempeño comercial.

---
# 4.16 ¿La popularidad del elenco está directamente correlacionada con el éxito de taquilla?
```{r}
# Cálculo de la popularidad promedio del elenco sin modificar el dataset
actors_popularity_avg <- sapply(
  movies$actorsPopularity,
  function(x) mean(as.numeric(unlist(strsplit(x, "\\|"))), na.rm = TRUE)
)

# Correlación entre popularidad del elenco e ingresos
cor(actors_popularity_avg, movies$revenue, use = "complete.obs")

# Gráfico de dispersión
plot(actors_popularity_avg, movies$revenue,
     xlab = "Popularidad promedio del elenco",
     ylab = "Ingresos",
     main = "Popularidad del elenco vs Ingresos")
```
Se observa una relación positiva entre la popularidad promedio del elenco
y los ingresos de taquilla, lo que indica que películas con actores más
populares tienden a obtener mejores resultados comerciales.

---
# Preguntas extra

# 5.1 ¿Las películas más largas tienden a generar mayores ingresos?
```{r}
plot(movies$runtime, movies$revenue,
     xlab = "Duración (minutos)",
     ylab = "Ingresos",
     main = "Duración vs Ingresos")
```
No se observa una relación fuerte entre la duración de una película
y sus ingresos. Películas largas y cortas pueden tener tanto
altos como bajos ingresos, por lo que la duración no parece ser
un factor determinante del éxito comercial.
---

#5.2 ¿El número de países de producción influye en los ingresos?
```{r}
boxplot(revenue ~ productionCountriesAmount, data = movies,
        xlab = "Cantidad de países de producción",
        ylab = "Ingresos",
        main = "Ingresos según países de producción")
```
Las películas producidas en varios países tienden a presentar
mayores ingresos medianos, lo que sugiere que las coproducciones
internacionales pueden ampliar el alcance comercial.
---
#5.3 ¿Las películas con más compañías productoras generan mayores ingresos?
```{r}
plot(movies$productionCoAmount, movies$revenue,
     xlab = "Cantidad de compañías productoras",
     ylab = "Ingresos",
     main = "Compañías productoras vs Ingresos")
```
Existe una ligera tendencia positiva entre la cantidad de compañías
productoras y los ingresos, indicando que mayores alianzas
pueden facilitar mejores resultados financieros.
---
#5.4 ¿El idioma original de la película influye en su popularidad?   
```{r}
aggregate(popularity ~ originalLanguage, data = movies, mean)

Se observan diferencias claras en la popularidad promedio según
el idioma original. Algunos idiomas concentran mayores niveles
de popularidad, posiblemente por su mayor alcance internacional.
```
---
#5.5 ¿Las películas con más géneros tienden a ser más populares?
```{r}
plot(movies$genresAmount, movies$popularity,
     xlab = "Cantidad de géneros",
     ylab = "Popularidad",
     main = "Cantidad de géneros vs Popularidad")
```
No existe una relación fuerte entre la cantidad de géneros y la
popularidad. Las películas con uno o varios géneros pueden
alcanzar niveles similares de popularidad.
---
#5.6 ¿Las películas con mayor número de votos tienden a tener mejores calificaciones promedio?
```{r}
plot(movies$voteCount, movies$voteAvg,
     xlab = "Cantidad de votos",
     ylab = "Calificación promedio",
     main = "Votos vs Calificación promedio")
```
Se observa una relación moderada donde las películas con más votos
tienden a estabilizar sus calificaciones promedio, lo que indica
mayor consenso del público conforme aumenta la cantidad de votaciones.