longest_genre_counts$n,
names.arg = longest_genre_counts$mainGenre,
las = 2,
main = paste("Género principal de las", topN, "películas más largas"),
ylab = "Cantidad de películas",
xlab = "Género principal"
)
revenue_by_genre <- movies %>%
filter(
!is.na(mainGenre), mainGenre != "",
!is.na(revenue), revenue > 0
) %>%
group_by(mainGenre) %>%
summarise(
total_revenue = sum(revenue, na.rm = TRUE),
n_movies = n()
) %>%
arrange(desc(total_revenue))
top10_revenue_genres <- head(revenue_by_genre, 10)
barplot(
top10_revenue_genres$total_revenue,
names.arg = top10_revenue_genres$mainGenre,
las = 2,
main = "Top 10 géneros principales con mayores ganancias (revenue total)",
ylab = "Revenue total",
xlab = "Género principal"
)
movies_corr <- movies %>%
filter(
!is.na(actorsAmount), actorsAmount > 0,
!is.na(revenue), revenue > 0
) %>%
select(actorsAmount, revenue)
pearson_cor  <- cor(movies_corr$actorsAmount, movies_corr$revenue, method = "pearson")
pearson_cor
actors_avg_by_20y <- movies %>%
filter(!is.na(releaseYear), !is.na(actorsAmount), actorsAmount > 0) %>%
mutate(
year_block_start = floor(releaseYear / 20) * 20,
year_block = paste0(year_block_start, "-", year_block_start + 19)
) %>%
group_by(year_block_start, year_block) %>%
summarise(
avg_actors_per_movie = mean(actorsAmount, na.rm = TRUE),
n_movies = n(),
.groups = "drop"
) %>%
arrange(year_block_start)
heights <- actors_avg_by_20y$avg_actors_per_movie
labels  <- actors_avg_by_20y$year_block
bp <- barplot(
heights,
names.arg = labels,
las = 2,
col = "steelblue",
main = "Promedio de actores por película por bloque de 20 años",
ylab = "Actores promedio por película (actorsAmount)",
xlab = "Bloque de años"
)
# Mostrar el valor promedio encima de cada barra (redondeado)
text(
x = bp,
y = heights,
labels = round(heights, 2),
pos = 3,
cex = 0.8
)
cast_impact <- movies %>%
filter(
!is.na(castMenAmount), !is.na(castWomenAmount),
castMenAmount >= 0, castWomenAmount >= 0,
!is.na(popularity), popularity > 0,
!is.na(revenue), revenue > 0
) %>%
mutate(
castGroup = case_when(
castMenAmount > castWomenAmount ~ "Más hombres",
castWomenAmount > castMenAmount ~ "Más mujeres",
TRUE ~ "Balanceado"
)
) %>%
group_by(castGroup) %>%
summarise(
n_movies = n(),
avg_popularity = mean(popularity, na.rm = TRUE),
avg_revenue = mean(revenue, na.rm = TRUE),
.groups = "drop"
)
cast_impact
budget_rev <- movies %>%
filter(!is.na(budget), !is.na(revenue), budget > 0, revenue > 0) %>%
select(budget, revenue)
plot(
budget_rev$budget,
budget_rev$revenue,
xlab = "Presupuesto (budget)",
ylab = "Ingresos (revenue)",
main = "Diagrama de dispersión: Presupuesto vs Ingresos"
)
pearson_cor <- cor(budget_rev$budget, budget_rev$revenue, method = "pearson")
pearson_cor
cor.test(budget_rev$budget, budget_rev$revenue, method = "pearson")
freq_pc_country_df <- as.data.frame(freqs$productionCompanyCountry)
colnames(freq_pc_country_df) <- c("Country", "Count")
freq_pc_country_df <- freq_pc_country_df %>%
arrange(desc(Count))
head(freq_pc_country_df, 20)
freqs <- lapply(movies_cual, table)
freq_pc_country <- movies_cual$productionCompanyCountry
freq_pc_country <- freq_pc_country[!is.na(freq_pc_country) & freq_pc_country != ""]
freq_pc_country <- sort(table(freq_pc_country), decreasing = TRUE)
head(freq_pc_country, 20)
freqs <- lapply(movies_cual, table)
freq_pc_country_df <- as.data.frame(freq_pc_country)
colnames(freq_pc_country_df) <- c("Country", "Count")
freq_pc_country_df <- freq_pc_country_df %>%
arrange(desc(Count))
head(freq_pc_country_df, 20)
freqs <- lapply(movies_cual, table)
clean_freq <- function(x, top_n = 20) {
x <- x[!is.na(x) & x != ""]
df <- as.data.frame(table(x))
colnames(df) <- c("Value", "Count")
df %>%
arrange(desc(Count)) %>%
head(top_n)
}
clean_freq(movies_cual$productionCompanyCountry)
clean_freq(movies_cual$video)
clean_freq(movies_cual$director)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$title)
clean_freq(movies_cual$originalLanguage)
clean_freq(movies_cual$releaseDate)
freqs <- lapply(movies_cual, table)
clean_freq <- function(x, top_n = 20) {
x <- x[!is.na(x)]
x <- trimws(x)
x <- stringr::str_squish(x)
x <- x[x != ""]
df <- as.data.frame(table(x))
colnames(df) <- c("Value", "Count")
df %>%
arrange(desc(Count)) %>%
head(top_n)
}
clean_freq(movies_cual$productionCompanyCountry)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$originalTitle)
clean_freq(movies_cual$originalTitle)
movies_cual$originalTitle
split_pipe <- function(x) {
if (is.na(x) || x == "") return(character(0))
parts <- unlist(strsplit(x, "\\|"))
parts <- trimws(parts)
parts[parts != ""]
}
split_pipe_num <- function(x) {
nums <- suppressWarnings(as.numeric(split_pipe(x)))
nums[!is.na(nums)]
}
safe_mean <- function(x) if (length(x) == 0) NA_real_ else mean(x, na.rm = TRUE)
movies_raw <- read.csv(
"movies_2026.csv",
stringsAsFactors = FALSE
)
movies <- movies_raw %>%
mutate(
# actorsPopularity -> métricas (para manejar 3.45|12.31|...)
actorsPopularity_mean = sapply(lapply(actorsPopularity, split_pipe_num), safe_mean),
)
movies_cuant <- movies[sapply(movies, is.numeric)]
movies_cual  <- movies[sapply(movies, function(x) !is.numeric(x))]
knitr::opts_chunk$set(echo = TRUE)
library(nortest)
library(dplyr)
library(stringr)
library(tidyr)
library(readr)
# Helpers para columnas con "|"
split_pipe <- function(x) {
if (is.na(x) || x == "") return(character(0))
parts <- unlist(strsplit(x, "\\|"))
parts <- trimws(parts)
parts[parts != ""]
}
split_pipe_num <- function(x) {
nums <- suppressWarnings(as.numeric(split_pipe(x)))
nums[!is.na(nums)]
}
safe_mean <- function(x) if (length(x) == 0) NA_real_ else mean(x, na.rm = TRUE)
movies_raw <- read.csv(
"movies_2026.csv",
stringsAsFactors = FALSE
)
movies <- movies_raw %>%
mutate(
# actorsPopularity -> métricas (para manejar 3.45|12.31|...)
actorsPopularity_mean = sapply(lapply(actorsPopularity, split_pipe_num), safe_mean),
)
movies_cuant <- movies[sapply(movies, is.numeric)]
movies_cual  <- movies[sapply(movies, function(x) !is.numeric(x))]
# Dimensión del conjunto de datos
dim(movies) #<-- Cuántas filas y columnas tiene el dataset
# Estructura de los datos
str(movies) #<--- Tipo de variables (numéricas, categóricas, texto, etc.)
# Resumen estadístico general
summary(movies) #<-- Exploración rápida:  - Mínimo, máximo, media, mediana (variables numéricas)  - Frecuencias (variables categóricas)\
lillie_results <- lapply(movies_cuant, lillie.test)
hist(movies_cuant$budget)
lillie_results$budget
hist(movies_cuant$revenue)
lillie_results$revenue
hist(movies_cuant$runtime)
lillie_results$runtime
hist(movies_cuant$popularity)
lillie_results$popularity
hist(movies_cuant$voteAvg)
lillie_results$voteAvg
hist(movies_cuant$voteCount)
lillie_results$voteCount
hist(movies_cuant$genresAmount)
lillie_results$genresAmount
hist(movies_cuant$productionCoAmount)
lillie_results$productionCoAmount
hist(movies_cuant$productionCountriesAmount)
lillie_results$productionCountriesAmount
hist(movies_cuant$actorsAmount)
lillie_results$actorsAmount
hist(movies_cuant$castWomenAmount)
lillie_results$castWomenAmount
hist(movies_cuant$castMenAmount)
lillie_results$castMenAmount
hist(movies_cuant$releaseYear)
lillie_results$releaseYear
hist(movies_cuant$actorsPopularity_mean)
lillie_results$actorsPopularity_mean
freqs <- lapply(movies_cual, table)
clean_freq <- function(x, top_n = 20) {
x <- x[!is.na(x)]
x <- trimws(x)
x <- stringr::str_squish(x)
x <- x[x != ""]
df <- as.data.frame(table(x))
colnames(df) <- c("Value", "Count")
df %>%
arrange(desc(Count)) %>%
head(top_n)
}
clean_freq(movies_cual$productionCompanyCountry)
clean_freq(movies_cual$video)
clean_freq(movies_cual$director)
knitr::opts_chunk$set(echo = TRUE)
library(nortest)
library(dplyr)
library(stringr)
library(tidyr)
library(readr)
# Helpers para columnas con "|"
split_pipe <- function(x) {
if (is.na(x) || x == "") return(character(0))
parts <- unlist(strsplit(x, "\\|"))
parts <- trimws(parts)
parts[parts != ""]
}
split_pipe_num <- function(x) {
nums <- suppressWarnings(as.numeric(split_pipe(x)))
nums[!is.na(nums)]
}
safe_mean <- function(x) if (length(x) == 0) NA_real_ else mean(x, na.rm = TRUE)
movies_raw <- readr::read_csv(
"movies_2026.csv",
locale = readr::locale(encoding = "latin1"),
show_col_types = FALSE
)
movies <- movies_raw %>%
mutate(
# actorsPopularity -> métricas (para manejar 3.45|12.31|...)
actorsPopularity_mean = sapply(lapply(actorsPopularity, split_pipe_num), safe_mean),
)
movies_cuant <- movies[sapply(movies, is.numeric)]
movies_cual  <- movies[sapply(movies, function(x) !is.numeric(x))]
# Dimensión del conjunto de datos
dim(movies) #<-- Cuántas filas y columnas tiene el dataset
# Estructura de los datos
str(movies) #<--- Tipo de variables (numéricas, categóricas, texto, etc.)
# Resumen estadístico general
summary(movies) #<-- Exploración rápida:  - Mínimo, máximo, media, mediana (variables numéricas)  - Frecuencias (variables categóricas)\
lillie_results <- lapply(movies_cuant, lillie.test)
hist(movies_cuant$budget)
lillie_results$budget
hist(movies_cuant$revenue)
lillie_results$revenue
hist(movies_cuant$runtime)
lillie_results$runtime
hist(movies_cuant$popularity)
lillie_results$popularity
hist(movies_cuant$voteAvg)
lillie_results$voteAvg
hist(movies_cuant$voteCount)
lillie_results$voteCount
hist(movies_cuant$genresAmount)
lillie_results$genresAmount
hist(movies_cuant$productionCoAmount)
lillie_results$productionCoAmount
hist(movies_cuant$productionCountriesAmount)
lillie_results$productionCountriesAmount
hist(movies_cuant$actorsAmount)
lillie_results$actorsAmount
hist(movies_cuant$castWomenAmount)
lillie_results$castWomenAmount
hist(movies_cuant$castMenAmount)
lillie_results$castMenAmount
hist(movies_cuant$releaseYear)
lillie_results$releaseYear
hist(movies_cuant$actorsPopularity_mean)
lillie_results$actorsPopularity_mean
freqs <- lapply(movies_cual, table)
clean_freq <- function(x, top_n = 20) {
x <- x[!is.na(x)]
x <- trimws(x)
x <- stringr::str_squish(x)
x <- x[x != ""]
df <- as.data.frame(table(x))
colnames(df) <- c("Value", "Count")
df %>%
arrange(desc(Count)) %>%
head(top_n)
}
clean_freq(movies_cual$productionCompanyCountry)
clean_freq(movies_cual$video)
clean_freq(movies_cual$director)
clean_freq(movies_cual$originalTitle)
movies_cual$originalTitle
clean_freq(movies_cual$title)
clean_freq(movies_cual$originalLanguage)
clean_freq(movies_cual$releaseDate)
movies <- movies %>%
mutate(
mainGenre = sapply(genres, function(g) {
split_pipe(g)[1]
})
)
# pasar release date a Date
movies <- movies %>%
mutate(releaseDateParsed = as.Date(releaseDate))
top20_genre_counts <- top20_recent %>%
filter(!is.na(mainGenre), mainGenre != "") %>%
count(mainGenre, sort = TRUE)
barplot(
top20_genre_counts$n,
names.arg = top20_genre_counts$mainGenre,
las = 2,                         # gira etiquetas
col = "steelblue",
main = "Géneros principales de las 20 películas más recientes",
ylab = "Cantidad de películas",
xlab = "Género principal"
)
main_genre_counts <- movies %>%
filter(!is.na(mainGenre), mainGenre != "") %>%
count(mainGenre, sort = TRUE)
barplot(
main_genre_counts$n,
names.arg = main_genre_counts$mainGenre,
las = 2,
col = "steelblue",
main = "Distribución del género principal en el conjunto de datos",
ylab = "Cantidad de películas",
xlab = "Género principal"
)
topN <- 20
longest_movies <- movies %>%
filter(!is.na(mainGenre), mainGenre != "", !is.na(runtime), runtime > 0) %>%
arrange(desc(runtime)) %>%
slice_head(n = topN)
longest_genre_counts <- longest_movies %>%
count(mainGenre, sort = TRUE)
# Gráfico de barras
barplot(
longest_genre_counts$n,
names.arg = longest_genre_counts$mainGenre,
las = 2,
main = paste("Género principal de las", topN, "películas más largas"),
ylab = "Cantidad de películas",
xlab = "Género principal"
)
revenue_by_genre <- movies %>%
filter(
!is.na(mainGenre), mainGenre != "",
!is.na(revenue), revenue > 0
) %>%
group_by(mainGenre) %>%
summarise(
total_revenue = sum(revenue, na.rm = TRUE),
n_movies = n()
) %>%
arrange(desc(total_revenue))
top10_revenue_genres <- head(revenue_by_genre, 10)
barplot(
top10_revenue_genres$total_revenue,
names.arg = top10_revenue_genres$mainGenre,
las = 2,
main = "Top 10 géneros principales con mayores ganancias (revenue total)",
ylab = "Revenue total",
xlab = "Género principal"
)
movies_corr <- movies %>%
filter(
!is.na(actorsAmount), actorsAmount > 0,
!is.na(revenue), revenue > 0
) %>%
select(actorsAmount, revenue)
pearson_cor  <- cor(movies_corr$actorsAmount, movies_corr$revenue, method = "pearson")
pearson_cor
actors_avg_by_20y <- movies %>%
filter(!is.na(releaseYear), !is.na(actorsAmount), actorsAmount > 0) %>%
mutate(
year_block_start = floor(releaseYear / 20) * 20,
year_block = paste0(year_block_start, "-", year_block_start + 19)
) %>%
group_by(year_block_start, year_block) %>%
summarise(
avg_actors_per_movie = mean(actorsAmount, na.rm = TRUE),
n_movies = n(),
.groups = "drop"
) %>%
arrange(year_block_start)
heights <- actors_avg_by_20y$avg_actors_per_movie
labels  <- actors_avg_by_20y$year_block
bp <- barplot(
heights,
names.arg = labels,
las = 2,
col = "steelblue",
main = "Promedio de actores por película por bloque de 20 años",
ylab = "Actores promedio por película (actorsAmount)",
xlab = "Bloque de años"
)
# Mostrar el valor promedio encima de cada barra (redondeado)
text(
x = bp,
y = heights,
labels = round(heights, 2),
pos = 3,
cex = 0.8
)
cast_impact <- movies %>%
filter(
!is.na(castMenAmount), !is.na(castWomenAmount),
castMenAmount >= 0, castWomenAmount >= 0,
!is.na(popularity), popularity > 0,
!is.na(revenue), revenue > 0
) %>%
mutate(
castGroup = case_when(
castMenAmount > castWomenAmount ~ "Más hombres",
castWomenAmount > castMenAmount ~ "Más mujeres",
TRUE ~ "Balanceado"
)
) %>%
group_by(castGroup) %>%
summarise(
n_movies = n(),
avg_popularity = mean(popularity, na.rm = TRUE),
avg_revenue = mean(revenue, na.rm = TRUE),
.groups = "drop"
)
cast_impact
budget_rev <- movies %>%
filter(!is.na(budget), !is.na(revenue), budget > 0, revenue > 0) %>%
select(budget, revenue)
plot(
budget_rev$budget,
budget_rev$revenue,
xlab = "Presupuesto (budget)",
ylab = "Ingresos (revenue)",
main = "Diagrama de dispersión: Presupuesto vs Ingresos"
)
pearson_cor <- cor(budget_rev$budget, budget_rev$revenue, method = "pearson")
pearson_cor
cor.test(budget_rev$budget, budget_rev$revenue, method = "pearson")
top10_budget <- movies[order(movies$budget, decreasing = TRUE), c("title", "budget")]
head(top10_budget, 10)
```{r}
top10_revenue <- movies[order(movies$revenue, decreasing = TRUE, na.last = TRUE),
c("title", "revenue")]
head(top10_revenue, 10)
pelicula_mas_votos <- movies[order(movies$voteCount, decreasing = TRUE, na.last = TRUE),
c("title", "voteCount")]
head(pelicula_mas_votos, 1)
peor_pelicula <- movies[
order(movies$voteAvg, decreasing = FALSE, na.last = TRUE),
c("title", "voteAvg")
]
head(peor_pelicula, 1)
pelis_por_anio <- table(movies$releaseYear)
anio_mas_peliculas <- data.frame(
Anio = names(pelis_por_anio),
Cantidad = as.vector(pelis_por_anio)
)[which.max(pelis_por_anio), ]
barplot(
pelis_por_anio,
main = "Cantidad de películas por año",
xlab = "Año de lanzamiento",
ylab = "Número de películas",
las = 2
)
anio_mas_peliculas
